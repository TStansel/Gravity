exports.handler = async (event) => {
    event = event.payload
    console.log("Request Event:",event)
    
    let messageEvent = event.event;
    console.log("MessageE",messageEvent)
    
    if(!messageEvent.hasOwnProperty('thread_ts') || messageEvent.ts === messageEvent.thread_ts){
        
        let messageText = messageEvent.text;
        let channelID = messageEvent.channel;
        let messageID = messageEvent.ts;
        let userID = messageEvent.user;
        
        let payload = {
            data: {
                text: messageText,
                channelID: channelID,
                messageID: messageID,
                userID: userID,
            },
            passed:true
        }
        
        return buildResponse(payload);
    }
    event["passed"] = false
    return buildResponse(event);
};

function buildResponse(payload) {
    return {
        payload: payload
    }
}
